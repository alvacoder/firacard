<app-board-settings></app-board-settings>


<ng-container *ngIf="board; else loadingPage">
    <header class="container text-center">
        <div>
            <div class="my-5">
                <h2 class="text-center">
                    <span>{{board.boardTitle}}</span>
                    <span *ngIf="userDetail._id === board?.creatorId"
                        class="ml-2 cursor-pointer" data-toggle="modal" data-target="#createBoardModal" >
                        <i style="font-size: 20px;" class="fa fa-edit text-pry"></i>
                    </span>
                </h2>
            </div>
            <nav class=" d-flex justify-content-center nav-menu">
                <div *ngFor="let menu of navMenus" class="nav-item" (click)="navClick(menu.slug)" >
                    <h6 *ngIf="userDetail._id === board?.creatorId && menu.slug != 'add_to_board'" >
                        <span class="d-inline-block p-3 shadow-sm rounded-circle icon-circle">
                            <img [src]="'/assets/icons/'+ menu.icon" [alt]="menu.icon">
                        </span>
                        <span>{{menu.name}}</span>
                    </h6> 
                    <h6 *ngIf="menu.slug == 'add_to_board'" >
                        <span class="d-inline-block p-3 shadow-sm rounded-circle icon-circle">
                            <img [src]="'/assets/icons/'+ menu.icon" [alt]="menu.icon">
                        </span>
                        <span>{{menu.name}}</span>
                    </h6> 

                </div>
            </nav> 
        </div>
    </header>
    <div class="main-container">
        <section class="container">
            <div class="row">
                <div class="col-md-4 my-4" *ngFor="let card of board.cards; let i = index">
                    <div class="card rounded-lg">
                        <div class="card-body">
                            <ng-container *ngIf="card.mediaType === 'image' || card.mediaType === 'gif'">
                                <img *ngIf="card.mediaUrl" class="card-img-top" height="80%" [src]="card.mediaUrl" alt="img">
                            </ng-container>
                            <ng-container *ngIf="card.mediaType === 'video' ">
                                <ng-container *ngIf="card.mediaUrl; else noVideoMediaUrl">
                                    <ng-container *ngIf="card.mediaUrl.includes('youtube'); else uploadedVideo">
                                        <iframe height="250"
                                          [src]="domSanitizer.bypassSecurityTrustResourceUrl(getYoutubeEmbedUrl(card.mediaUrl))">
                                       </iframe>
                                    </ng-container>
                                    <ng-template #uploadedVideo>
                                        <video width="100%" height="250" controls>
                                            <source id="videoIDSelector" [src]="card.mediaUrl" type="video/mp4">
                                          Your browser does not support the video tag.
                                          </video>
                                    </ng-template>
                                </ng-container>
                                <ng-template #noVideoMediaUrl>
                                    <p>No mediaurl</p>
                                </ng-template>
                            </ng-container>
                            <p class="card-text mt-5">{{card.postContent}}</p>
                        </div>
                        <div class="card-footer d-flex justify-content-lg-between">
                            <div >
                                <div class="dropdown" *ngIf="card.creatorId?._id == userDetail._id">
                                    <a class="dropdown-toggle text-light" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fa fa-ellipsis-h text-dark"></i>
                                      </a>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                      <a class="dropdown-item cursor-pointer" (click)="editCard(card._id)">Edit</a>
                                      <a class="dropdown-item" href="#">Delete</a>
                                    </div>
                                  </div>
                            </div>
                            <div><p><span class="text-muted">From</span> {{(card.creatorName || (card.creatorId?.firstName) || 'nil')}}</p></div>
                        </div>
                      </div>
                    </div>
            </div>
        </section>
    </div>
<app-create-board [board]="board" (emitEvent)="getBoard()" ></app-create-board>

</ng-container>
<ng-template #loadingPage>
    <app-loader></app-loader>
</ng-template>