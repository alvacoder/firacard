
<ng-container *ngIf="board; else loadingPage">
     
    <app-board-settings (emitEvent)="eventEmitted($event)" [board]="board"  #boardSettingComp></app-board-settings>
    <app-send-board  [board]="board" [boardUrl]="boardLink" (emitEvent)="eventEmitted($event)" ></app-send-board>
    <section class="py-5 main-header"  
        [style.background]="seletedTemplate.header_color"
        [style.color]="seletedTemplate.font_color"
    >
        <header class="container text-center">
            <div>
                <div class="">
                    <h2 class="text-center">
                        <span>{{board.boardTitle}}</span>
                        <span *ngIf="userDetail._id === board?.creatorId?._id"
                            class="ml-2 cursor-pointer" data-toggle="modal" data-target="#createBoardModal" >
                            <i style="font-size: 20px;" class="fa fa-edit"></i>
                        </span>
                    </h2>
                </div>
                <nav class="mt-3 d-flex justify-content-center nav-menu">
                    <div *ngFor="let menu of navMenus" class="nav-item" (click)="navClick(menu.slug)" >
                        <h6  *ngIf="userDetail._id === board?.creatorId?._id && menu.slug != 'add_to_board'" >
                            <span class="d-inline-block p-3 shadow-sm rounded-circle icon-circle" 
                                [style.background]="seletedTemplate.header_color">
                                <i class="fa {{menu.icon}}"></i>
                            </span>
                            <span class="ml-2">{{menu.name}}</span>
                        </h6> 
                        <h6  *ngIf="menu.slug == 'add_to_board'" >
                            <span class="d-inline-block p-3 shadow-sm rounded-circle icon-circle"
                                [style.background]="seletedTemplate.header_color">
                                <i class="fa {{menu.icon}}"></i>
                            </span>
                            <span class="ml-2">{{menu.name}}</span>
                        </h6> 
    
                    </div>
                </nav> 
            </div>
        </header>
    </section>
    <div [style.background]="
        seletedTemplate.low_res_url ? 'url('+seletedTemplate.low_res_url+')': 
        seletedTemplate.background_color" 
        class="main-container" 
    >
        <section class="container">
            <div class="row-content">
                <div class="column-md-3 my-4" *ngFor="let card of board.cards; let i = index">
                    <div class="card w-100 rounded-lg">
                        <div class="card-body">
                            <ng-container *ngIf="card.mediaType === 'image' || card.mediaType === 'gif'">
                                <img *ngIf="card.mediaUrl" class="card-img-top" height="80%" [src]="card.mediaUrl" alt="img">
                            </ng-container>
                            <ng-container *ngIf="card.mediaType === 'video' ">
                                <ng-container *ngIf="card.mediaUrl; else noVideoMediaUrl">
                                    <ng-container *ngIf="card.mediaUrl.includes('youtube'); else uploadedVideo">
                                        <iframe height="250"
                                          [src]="domSanitizer.bypassSecurityTrustResourceUrl(getYoutubeEmbedUrl(card.mediaUrl))">
                                       </iframe>
                                    </ng-container>
                                    <ng-template #uploadedVideo>
                                        <video width="100%" height="250" controls>
                                            <source id="videoIDSelector" [src]="card.mediaUrl" type="video/mp4">
                                          Your browser does not support the video tag.
                                          </video>
                                    </ng-template>
                                </ng-container>
                                <ng-template #noVideoMediaUrl>
                                    <p>No mediaurl</p>
                                </ng-template>
                            </ng-container>
                            <p class="card-text mt-5">{{card.postContent}}</p>
                        </div>
                        <div class="card-footer d-flex justify-content-lg-between">
                            <div >
                                <div class="dropdown" *ngIf="card.creatorId?._id == userDetail._id">
                                    <a class="dropdown-toggle text-light" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="fa fa-ellipsis-h text-dark"></i>
                                      </a>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                      <a class="dropdown-item cursor-pointer" (click)="editCard(card._id)">Edit</a>
                                      <a class="dropdown-item" href="#">Delete</a>
                                    </div>
                                  </div>
                            </div>
                            <div><p><span class="text-muted">From</span> {{(card.creatorName || (card.creatorId?.firstName) || 'nil')}}</p></div>
                        </div>
                      </div>
                    </div>
            </div>
        </section>
    </div>
<app-create-board [board]="board" (emitEvent)="getBoard()" ></app-create-board>
 <!--Direct Link-->
 <input type="text" id="contr_direct_link" [value]="boardLink" class="d-none">
<!-- Button trigger modal -->
<button type="button" id="inviteContrBtn" class="btn btn-primary d-none" data-toggle="modal" data-target="#inviteContributors">
    invite user
  </button>

  
  <!-- Invite Contributors Modal -->
  <div class="modal fade" id="inviteContributors" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="">
            <div class="text-right mr-2">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span style="font-size: 30px;" aria-hidden="true">&times;</span>
              </button>
            </div>
            <h4 class="mt-3 modal-title text-center">Invite Contributors</h4>
          </div>
        <div class="modal-body">
            <ul class="nav nav-tabs mb-2" id="myTab" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Email Invite</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Direct Link</a>
                </li>
              </ul>
              <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                    <div >
                        <div class="form-group">
                            <label>Contributorâ€™s Email</label>
                            <input [(ngModel)]="contributorsEmail" name="contributorEmail" type="text"
                                placeholder="use a comma to seprate emails" class="form-control mb-2">
                            <!-- <p (click)="addMoreContributor()" class="cursor-pointer text-right text-pry ">+ more contributors</p> -->
                        </div>
                        <div class="form-group">
                            <div class="d-flex">
                                <p>
                                    Notify contributors that they have been invited to edit and contribute to the board.
                                </p>
                                <div>
                                    <div class="custom-control custom-switch pry">
                                        <input type="checkbox" class="custom-control-input" id="customSwitch1">
                                        <label class="custom-control-label" for="customSwitch1"></label>
                                      </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="d-flex">
                                <p>
                                    Notify contributors 24hrs before scheduled delivery of  delivery time.
                                </p>
                                <div>
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="customSwitch2">
                                        <label class="custom-control-label" for="customSwitch2"></label>
                                      </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-2">
                            <button [disabled]="!contributorsEmail || laodingSendInvite" (click)="sendInvite()" type="button" class="btn btn-pry btn-block">
                                Send Invite <i *ngIf="laodingSendInvite" class="fa fa-spinner fa-spin"></i>
                            </button>
                          </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                    <button class="btn btn-copy btn-block my-4">
                        <span>{{boardLink}}</span>
                    </button>

                    <button (click)="copyDirectLink()" class="btn btn-pry mt-3 btn-block">Copy invite Link</button>
                </div>
              </div>
        </div>
      </div>
    </div>
  </div>

</ng-container>
<ng-template #loadingPage>
    <app-loader></app-loader>
</ng-template>